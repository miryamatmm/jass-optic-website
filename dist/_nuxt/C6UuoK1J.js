import{r as i,i as S,f as k,c as d,a as t,l as c,v as p,g as u,m,F as h,k as $,j as T,o as f,t as v}from"./dDCsOtge.js";const E={class:"page admin-slots"},V={class:"card"},x={class:"form-grid"},C={class:"slot-admin-line"},F={class:"slot-hour"},U=["onClick"],L={__name:"slots",setup(j){const y=T(),_=i([]),a=i(""),s=i(""),l=i("");async function r(){_.value=await $fetch(`${y.public.supabaseUrl}/rest/v1/slots?select=*`,{headers:{apikey:y.public.supabaseAnonKey}})}S(r);const g=k(()=>{const o=new Date;return _.value.filter(e=>new Date(`${e.date}T${e.end_time}`)>o)});async function w(){if(!a.value||!s.value||!l.value)return alert("Veuillez remplir tous les champs");await $fetch("/api/admin/add-slot",{method:"POST",body:{date:a.value,start_time:s.value,end_time:l.value}}),a.value="",s.value="",l.value="",r()}async function D(o){confirm("Supprimer ce créneau ?")&&(await $fetch(`/api/admin/delete-slot/${o}`,{method:"DELETE"}),r())}function b(o){return new Date(o).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}return(o,e)=>(f(),d("div",E,[e[5]||(e[5]=t("h1",null," Gestion des créneaux ",-1)),t("div",V,[e[3]||(e[3]=t("h2",null,"Ajouter un créneau",-1)),e[4]||(e[4]=t("p",{class:"step-desc"}," Définissez une date et un horaire de disponibilité. ",-1)),t("div",x,[c(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=n=>m(a)?a.value=n:null),class:"input"},null,512),[[p,u(a)]]),c(t("input",{type:"time",step:"300","onUpdate:modelValue":e[1]||(e[1]=n=>m(s)?s.value=n:null),class:"input"},null,512),[[p,u(s)]]),c(t("input",{type:"time",step:"300","onUpdate:modelValue":e[2]||(e[2]=n=>m(l)?l.value=n:null),class:"input"},null,512),[[p,u(l)]])]),t("button",{type:"button",class:"btn cta",onClick:w}," Ajouter le créneau ")]),(f(!0),d(h,null,$(u(g),n=>(f(),d("div",{class:"card",key:n.id},[t("div",C,[t("div",null,[t("strong",null,v(b(n.date)),1),t("p",F,v(n.start_time)+" → "+v(n.end_time),1)]),t("button",{class:"btn danger",onClick:A=>D(n.id)}," Supprimer ",8,U)])]))),128))]))}};export{L as default};
